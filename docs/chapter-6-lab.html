<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Chapter 6 Lab | Time Series</title>
  <meta name="description" content="12 Chapter 6 Lab | Time Series" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Chapter 6 Lab | Time Series" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Chapter 6 Lab | Time Series" />
  
  
  

<meta name="author" content="Luke Le" />


<meta name="date" content="2021-11-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-6-forecasting.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html"><i class="fa fa-check"></i><b>1</b> Chapter 1: Time Series Fundamentals</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#definition"><i class="fa fa-check"></i><b>1.1</b> Definition</a></li>
<li class="chapter" data-level="1.2" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#white-noise-purely-random-process"><i class="fa fa-check"></i><b>1.2</b> White Noise: purely random process</a></li>
<li class="chapter" data-level="1.3" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#random-walk-random-but-dependent"><i class="fa fa-check"></i><b>1.3</b> Random Walk: random but dependent</a></li>
<li class="chapter" data-level="1.4" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#time-series-modelling"><i class="fa fa-check"></i><b>1.4</b> Time Series Modelling</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#log-transformation"><i class="fa fa-check"></i><b>1.4.1</b> Log Transformation</a></li>
<li class="chapter" data-level="1.4.2" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#box-cox-transformation"><i class="fa fa-check"></i><b>1.4.2</b> Box-Cox Transformation</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#time-series-properties"><i class="fa fa-check"></i><b>1.5</b> Time Series Properties</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#mean-function-if-mean-is-constant"><i class="fa fa-check"></i><b>1.5.1</b> Mean function (if mean is constant)</a></li>
<li class="chapter" data-level="1.5.2" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#variance-function-if-variance-is-constant"><i class="fa fa-check"></i><b>1.5.2</b> Variance function (if variance is constant)</a></li>
<li class="chapter" data-level="1.5.3" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#autocovariance-function-acvf"><i class="fa fa-check"></i><b>1.5.3</b> Autocovariance function (ACVF):</a></li>
<li class="chapter" data-level="1.5.4" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#autocorrelation-function-acf"><i class="fa fa-check"></i><b>1.5.4</b> Autocorrelation function (ACF):</a></li>
<li class="chapter" data-level="1.5.5" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#properties"><i class="fa fa-check"></i><b>1.5.5</b> Properties</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#stationarity"><i class="fa fa-check"></i><b>1.6</b> Stationarity</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html"><i class="fa fa-check"></i><b>2</b> Chapter 1 Lab</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html#white-noise-wn"><i class="fa fa-check"></i><b>2.1</b> White Noise (WN)</a></li>
<li class="chapter" data-level="2.2" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html#random-walk-rw"><i class="fa fa-check"></i><b>2.2</b> Random Walk (RW)</a></li>
<li class="chapter" data-level="2.3" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html#stationary"><i class="fa fa-check"></i><b>2.3</b> Stationary</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html#examples-cpi-data"><i class="fa fa-check"></i><b>2.3.1</b> Examples: CPI Data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html#acf-to-time-series-plot"><i class="fa fa-check"></i><b>2.4</b> ACF to Time Series Plot</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html"><i class="fa fa-check"></i><b>3</b> Chapter 2: Modelling trends and seasonal patterns</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#method-1-regression"><i class="fa fa-check"></i><b>3.1</b> Method 1: Regression</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#examples"><i class="fa fa-check"></i><b>3.1.1</b> Examples</a></li>
<li class="chapter" data-level="3.1.2" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#other-common-models"><i class="fa fa-check"></i><b>3.1.2</b> Other common models</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#method-2-moving-average-smoothing"><i class="fa fa-check"></i><b>3.2</b> Method 2: Moving Average Smoothing</a></li>
<li class="chapter" data-level="3.3" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#method-3-differencing"><i class="fa fa-check"></i><b>3.3</b> Method 3: Differencing</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#remove-trends"><i class="fa fa-check"></i><b>3.3.1</b> Remove Trends</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#remove-seasonality"><i class="fa fa-check"></i><b>3.3.2</b> Remove Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#choosing-a-smoothing-parameter"><i class="fa fa-check"></i><b>3.4</b> Choosing a smoothing parameter</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#simplicity"><i class="fa fa-check"></i><b>3.4.1</b> Simplicity</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#objective-criteria-aic-bic"><i class="fa fa-check"></i><b>3.4.2</b> Objective criteria (AIC &amp; BIC)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-2-lab.html"><a href="chapter-2-lab.html"><i class="fa fa-check"></i><b>4</b> Chapter 2 Lab</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-2-lab.html"><a href="chapter-2-lab.html#model-choice-and-residual-analysis"><i class="fa fa-check"></i><b>4.1</b> Model choice and Residual analysis</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-2-lab.html"><a href="chapter-2-lab.html#data-example-annual-varve-series"><i class="fa fa-check"></i><b>4.2</b> Data Example: Annual Varve Series</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html"><i class="fa fa-check"></i><b>5</b> Chapter 3: Autoregressive processes</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#definition"><i class="fa fa-check"></i><b>5.1</b> Definition</a></li>
<li class="chapter" data-level="5.2" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#first-order-autoregressive-process"><i class="fa fa-check"></i><b>5.2</b> First order Autoregressive process</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#mean"><i class="fa fa-check"></i><b>5.2.1</b> Mean</a></li>
<li class="chapter" data-level="5.2.2" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#variance"><i class="fa fa-check"></i><b>5.2.2</b> Variance</a></li>
<li class="chapter" data-level="5.2.3" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#examples"><i class="fa fa-check"></i><b>5.2.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#arp-process"><i class="fa fa-check"></i><b>5.3</b> <span class="math inline">\(AR(p)\)</span> process</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#mean-1"><i class="fa fa-check"></i><b>5.3.1</b> Mean</a></li>
<li class="chapter" data-level="5.3.2" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#stationarity"><i class="fa fa-check"></i><b>5.3.2</b> Stationarity</a></li>
<li class="chapter" data-level="5.3.3" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#variance-1"><i class="fa fa-check"></i><b>5.3.3</b> Variance</a></li>
<li class="chapter" data-level="5.3.4" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#autocorrelation-function"><i class="fa fa-check"></i><b>5.3.4</b> Autocorrelation Function</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#when-and-how-to-use-arp-model"><i class="fa fa-check"></i><b>5.4</b> When and how to use AR(p) model</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#definition-of-pacf"><i class="fa fa-check"></i><b>5.4.1</b> Definition of PACF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter-3-lab.html"><a href="chapter-3-lab.html"><i class="fa fa-check"></i><b>6</b> Chapter 3 Lab</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-3-lab.html"><a href="chapter-3-lab.html#autoregressive-model-ar"><i class="fa fa-check"></i><b>6.1</b> Autoregressive model (AR)</a></li>
<li class="chapter" data-level="6.2" data-path="chapter-3-lab.html"><a href="chapter-3-lab.html#chicken-price"><i class="fa fa-check"></i><b>6.2</b> Chicken Price</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-3-lab.html"><a href="chapter-3-lab.html#chicken-price-1"><i class="fa fa-check"></i><b>6.3</b> Chicken price</a></li>
<li class="chapter" data-level="6.4" data-path="chapter-3-lab.html"><a href="chapter-3-lab.html#unemployment"><i class="fa fa-check"></i><b>6.4</b> Unemployment</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html"><i class="fa fa-check"></i><b>7</b> Chapter 4: Moving Average processes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#definition"><i class="fa fa-check"></i><b>7.1</b> Definition</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#mean-and-variance"><i class="fa fa-check"></i><b>7.2</b> Mean and Variance</a></li>
<li class="chapter" data-level="7.3" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#autocorrelation-functions"><i class="fa fa-check"></i><b>7.3</b> Autocorrelation functions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#examples"><i class="fa fa-check"></i><b>7.3.1</b> Examples:</a></li>
<li class="chapter" data-level="7.3.2" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#another-example"><i class="fa fa-check"></i><b>7.3.2</b> Another example</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#invertibility"><i class="fa fa-check"></i><b>7.4</b> Invertibility</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#inveritibility-theorem"><i class="fa fa-check"></i><b>7.4.1</b> Inveritibility Theorem</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#ma-model-identification"><i class="fa fa-check"></i><b>7.5</b> MA Model Identification</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#example"><i class="fa fa-check"></i><b>7.5.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#ma-parameter-estimation"><i class="fa fa-check"></i><b>7.6</b> MA parameter estimation</a></li>
<li class="chapter" data-level="7.7" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#ma-example"><i class="fa fa-check"></i><b>7.7</b> MA Example</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-4-lab.html"><a href="chapter-4-lab.html"><i class="fa fa-check"></i><b>8</b> Chapter 4 Lab</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-4-lab.html"><a href="chapter-4-lab.html#moving-average-model-ma"><i class="fa fa-check"></i><b>8.1</b> Moving Average model (MA)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html"><i class="fa fa-check"></i><b>9</b> Chapter 5: More general time series processes</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arma-model"><i class="fa fa-check"></i><b>9.1</b> ARMA model</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#mean-of-armapq-process"><i class="fa fa-check"></i><b>9.1.1</b> Mean of ARMA(p,q) process</a></li>
<li class="chapter" data-level="9.1.2" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#variance-and-autocorrelation-function"><i class="fa fa-check"></i><b>9.1.2</b> Variance and autocorrelation function</a></li>
<li class="chapter" data-level="9.1.3" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#stationarity-and-invertibility"><i class="fa fa-check"></i><b>9.1.3</b> Stationarity and Invertibility</a></li>
<li class="chapter" data-level="9.1.4" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arma-model-identification"><i class="fa fa-check"></i><b>9.1.4</b> ARMA model identification</a></li>
<li class="chapter" data-level="9.1.5" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arma-parameter-estimation"><i class="fa fa-check"></i><b>9.1.5</b> ARMA parameter estimation</a></li>
<li class="chapter" data-level="9.1.6" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arma-simulation-example"><i class="fa fa-check"></i><b>9.1.6</b> ARMA simulation example</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arima-model"><i class="fa fa-check"></i><b>9.2</b> ARIMA model</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#definition"><i class="fa fa-check"></i><b>9.2.1</b> Definition</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arima-model-identification"><i class="fa fa-check"></i><b>9.2.2</b> ARIMA model identification</a></li>
<li class="chapter" data-level="9.2.3" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#example-1"><i class="fa fa-check"></i><b>9.2.3</b> Example 1</a></li>
<li class="chapter" data-level="9.2.4" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#example-2"><i class="fa fa-check"></i><b>9.2.4</b> Example 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter-5-lab.html"><a href="chapter-5-lab.html"><i class="fa fa-check"></i><b>10</b> Chapter 5 Lab</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter-5-lab.html"><a href="chapter-5-lab.html#oil-return"><i class="fa fa-check"></i><b>10.1</b> Oil Return</a></li>
<li class="chapter" data-level="10.2" data-path="chapter-5-lab.html"><a href="chapter-5-lab.html#air-passengers"><i class="fa fa-check"></i><b>10.2</b> Air Passengers</a></li>
<li class="chapter" data-level="10.3" data-path="chapter-5-lab.html"><a href="chapter-5-lab.html#birth-rate"><i class="fa fa-check"></i><b>10.3</b> Birth Rate</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html"><i class="fa fa-check"></i><b>11</b> Chapter 6: Forecasting</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#general-problem"><i class="fa fa-check"></i><b>11.1</b> General problem</a></li>
<li class="chapter" data-level="11.2" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#regression"><i class="fa fa-check"></i><b>11.2</b> Regression</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#example-1"><i class="fa fa-check"></i><b>11.2.1</b> Example 1</a></li>
<li class="chapter" data-level="11.2.2" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#example-2"><i class="fa fa-check"></i><b>11.2.2</b> Example 2</a></li>
<li class="chapter" data-level="11.2.3" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#example-3"><i class="fa fa-check"></i><b>11.2.3</b> Example 3</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#exponential-smoothing"><i class="fa fa-check"></i><b>11.3</b> Exponential smoothing</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#definition"><i class="fa fa-check"></i><b>11.3.1</b> Definition</a></li>
<li class="chapter" data-level="11.3.2" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#choosing-alpha"><i class="fa fa-check"></i><b>11.3.2</b> Choosing <span class="math inline">\(\alpha\)</span></a></li>
<li class="chapter" data-level="11.3.3" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#measure-uncertainty"><i class="fa fa-check"></i><b>11.3.3</b> Measure uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#forecasting-from-arp-models"><i class="fa fa-check"></i><b>11.4</b> Forecasting from AR(p) models</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#ar1-forecasting"><i class="fa fa-check"></i><b>11.4.1</b> AR(1) forecasting</a></li>
<li class="chapter" data-level="11.4.2" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#arp-forecasting"><i class="fa fa-check"></i><b>11.4.2</b> AR(p) forecasting</a></li>
<li class="chapter" data-level="11.4.3" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#example-1-simulated-data"><i class="fa fa-check"></i><b>11.4.3</b> Example 1: Simulated data</a></li>
<li class="chapter" data-level="11.4.4" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#example-2-1"><i class="fa fa-check"></i><b>11.4.4</b> Example 2</a></li>
<li class="chapter" data-level="11.4.5" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#example-3-1"><i class="fa fa-check"></i><b>11.4.5</b> Example 3</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#forecasting-from-maq-models"><i class="fa fa-check"></i><b>11.5</b> Forecasting from MA(q) models</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#ma1-forecast"><i class="fa fa-check"></i><b>11.5.1</b> MA(1) forecast</a></li>
<li class="chapter" data-level="11.5.2" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#maq-forecasts"><i class="fa fa-check"></i><b>11.5.2</b> MA(q) forecasts</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#forecasting-time-series-with-trend-seasonality-and-correlation"><i class="fa fa-check"></i><b>11.6</b> Forecasting time series with trend, seasonality and correlation</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#example-4"><i class="fa fa-check"></i><b>11.6.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chapter-6-lab.html"><a href="chapter-6-lab.html"><i class="fa fa-check"></i><b>12</b> Chapter 6 Lab</a>
<ul>
<li class="chapter" data-level="12.1" data-path="chapter-6-lab.html"><a href="chapter-6-lab.html#forecasting-with-arima"><i class="fa fa-check"></i><b>12.1</b> Forecasting with ARIMA</a></li>
<li class="chapter" data-level="12.2" data-path="chapter-6-lab.html"><a href="chapter-6-lab.html#global-temp-data"><i class="fa fa-check"></i><b>12.2</b> Global Temp data</a></li>
<li class="chapter" data-level="12.3" data-path="chapter-6-lab.html"><a href="chapter-6-lab.html#exponential-smoothing-1"><i class="fa fa-check"></i><b>12.3</b> Exponential smoothing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-6-lab" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Chapter 6 Lab</h1>
<div id="forecasting-with-arima" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Forecasting with ARIMA</h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="chapter-6-lab.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa)</span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="chapter-6-lab.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot P/ACF pair of differenced data </span></span>
<span id="cb104-2"><a href="chapter-6-lab.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf2</span>(<span class="fu">diff</span>(x))</span></code></pre></div>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre><code>##       [,1]  [,2]  [,3] [,4]  [,5]  [,6]  [,7]  [,8] [,9] [,10] [,11] [,12]
## ACF  -0.12  0.00 -0.07 0.02 -0.06 -0.21  0.05 -0.09 0.09 -0.05 -0.12  0.12
## PACF -0.12 -0.02 -0.07 0.01 -0.05 -0.23 -0.01 -0.11 0.04 -0.04 -0.19  0.04
##      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20]
## ACF  -0.09  -0.1  0.00  0.00  0.01 -0.12  0.13 -0.05
## PACF -0.11  -0.2 -0.01 -0.11 -0.09 -0.17 -0.04 -0.12</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="chapter-6-lab.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model - check t-table and diagnostics</span></span>
<span id="cb106-2"><a href="chapter-6-lab.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima</span>(x, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## initial  value 0.137947 
## iter   2 value 0.130725
## iter   3 value 0.130723
## iter   4 value 0.130723
## iter   4 value 0.130723
## iter   4 value 0.130723
## final  value 0.130723 
## converged
## initial  value 0.128980 
## iter   2 value 0.128956
## iter   3 value 0.128954
## iter   3 value 0.128954
## iter   3 value 0.128954
## final  value 0.128954 
## converged</code></pre>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## stats::arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, 
##     Q), period = S), xreg = constant, transform.pars = trans, fixed = fixed, 
##     optim.control = list(trace = trc, REPORT = 1, reltol = tol))
## 
## Coefficients:
##           ar1  constant
##       -0.1192    0.0788
## s.e.   0.1000    0.1023
## 
## sigma^2 estimated as 1.294:  log likelihood = -153.24,  aic = 312.48
## 
## $degrees_of_freedom
## [1] 97
## 
## $ttable
##          Estimate     SE t.value p.value
## ar1       -0.1192 0.1000 -1.1921  0.2361
## constant   0.0788 0.1023  0.7707  0.4428
## 
## $AIC
## [1] 3.156391
## 
## $AICc
## [1] 3.157653
## 
## $BIC
## [1] 3.235031</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="chapter-6-lab.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast the data 20 time periods ahead</span></span>
<span id="cb109-2"><a href="chapter-6-lab.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima.for</span>(x, <span class="at">n.ahead =</span> <span class="dv">20</span>, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">d =</span> <span class="dv">1</span>, <span class="at">q =</span> <span class="dv">0</span>) </span></code></pre></div>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-4-3.png" width="672" /></p>
<pre><code>## $pred
## Time Series:
## Start = 101 
## End = 120 
## Frequency = 1 
##  [1] 37.93860 38.03106 38.10825 38.18726 38.26606 38.34488 38.42369 38.50251
##  [9] 38.58133 38.66015 38.73897 38.81778 38.89660 38.97542 39.05424 39.13306
## [17] 39.21187 39.29069 39.36951 39.44833
## 
## $se
## Time Series:
## Start = 101 
## End = 120 
## Frequency = 1 
##  [1] 1.137555 1.515934 1.826118 2.089843 2.323929 2.536493 2.732572 2.915493
##  [9] 3.087597 3.250601 3.405813 3.554253 3.696737 3.833930 3.966381 4.094549
## [17] 4.218825 4.339543 4.456993 4.571427</code></pre>
</div>
<div id="global-temp-data" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Global Temp data</h2>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="chapter-6-lab.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(globtemp)</span></code></pre></div>
<pre><code>## [1] -0.20 -0.11 -0.10 -0.20 -0.28 -0.31</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="chapter-6-lab.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(globtemp)</span></code></pre></div>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="chapter-6-lab.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit an ARIMA(0,1,2) to globtemp and check the fit</span></span>
<span id="cb114-2"><a href="chapter-6-lab.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima</span>(globtemp, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## initial  value -2.220513 
## iter   2 value -2.294887
## iter   3 value -2.307682
## iter   4 value -2.309170
## iter   5 value -2.310360
## iter   6 value -2.311251
## iter   7 value -2.311636
## iter   8 value -2.311648
## iter   9 value -2.311649
## iter   9 value -2.311649
## iter   9 value -2.311649
## final  value -2.311649 
## converged
## initial  value -2.310187 
## iter   2 value -2.310197
## iter   3 value -2.310199
## iter   4 value -2.310201
## iter   5 value -2.310202
## iter   5 value -2.310202
## iter   5 value -2.310202
## final  value -2.310202 
## converged</code></pre>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## stats::arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, 
##     Q), period = S), xreg = constant, transform.pars = trans, fixed = fixed, 
##     optim.control = list(trace = trc, REPORT = 1, reltol = tol))
## 
## Coefficients:
##           ma1      ma2  constant
##       -0.3984  -0.2173    0.0072
## s.e.   0.0808   0.0768    0.0033
## 
## sigma^2 estimated as 0.00982:  log likelihood = 120.32,  aic = -232.64
## 
## $degrees_of_freedom
## [1] 132
## 
## $ttable
##          Estimate     SE t.value p.value
## ma1       -0.3984 0.0808 -4.9313  0.0000
## ma2       -0.2173 0.0768 -2.8303  0.0054
## constant   0.0072 0.0033  2.1463  0.0337
## 
## $AIC
## [1] -1.723268
## 
## $AICc
## [1] -1.721911
## 
## $BIC
## [1] -1.637185</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="chapter-6-lab.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast data 35 years into the future</span></span>
<span id="cb117-2"><a href="chapter-6-lab.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima.for</span>(globtemp, <span class="dv">35</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span></code></pre></div>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-5-3.png" width="672" /></p>
<pre><code>## $pred
## Time Series:
## Start = 2016 
## End = 2050 
## Frequency = 1 
##  [1] 0.7995567 0.7745381 0.7816919 0.7888457 0.7959996 0.8031534 0.8103072
##  [8] 0.8174611 0.8246149 0.8317688 0.8389226 0.8460764 0.8532303 0.8603841
## [15] 0.8675379 0.8746918 0.8818456 0.8889995 0.8961533 0.9033071 0.9104610
## [22] 0.9176148 0.9247687 0.9319225 0.9390763 0.9462302 0.9533840 0.9605378
## [29] 0.9676917 0.9748455 0.9819994 0.9891532 0.9963070 1.0034609 1.0106147
## 
## $se
## Time Series:
## Start = 2016 
## End = 2050 
## Frequency = 1 
##  [1] 0.09909556 0.11564576 0.12175580 0.12757353 0.13313729 0.13847769
##  [7] 0.14361964 0.14858376 0.15338730 0.15804492 0.16256915 0.16697084
## [13] 0.17125943 0.17544322 0.17952954 0.18352490 0.18743511 0.19126540
## [19] 0.19502047 0.19870459 0.20232164 0.20587515 0.20936836 0.21280424
## [25] 0.21618551 0.21951471 0.22279416 0.22602604 0.22921235 0.23235497
## [31] 0.23545565 0.23851603 0.24153763 0.24452190 0.24747019</code></pre>
<p>Pure seasonal model takes 4 more parameters P, S, D, Q</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="chapter-6-lab.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot sample P/ACF to lag 60 and compare to the true values</span></span>
<span id="cb119-2"><a href="chapter-6-lab.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf2</span>(x, <span class="at">max.lag =</span> <span class="dv">60</span>)</span></code></pre></div>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre><code>##      [,1] [,2]  [,3]  [,4]  [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
## ACF   0.9 0.82  0.73  0.64  0.56 0.50 0.48 0.45 0.44  0.42  0.40   0.4  0.37
## PACF  0.9 0.04 -0.07 -0.04 -0.02 0.05 0.15 0.03 0.03 -0.07  0.04   0.1 -0.09
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
## ACF   0.35  0.36  0.36  0.37  0.36  0.36  0.34  0.34  0.32  0.29  0.27  0.20
## PACF  0.05  0.13  0.04  0.02 -0.08  0.06 -0.06  0.09 -0.02 -0.11 -0.01 -0.19
##      [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
## ACF   0.16  0.12  0.10  0.07  0.03  0.02  0.00 -0.03 -0.06 -0.08 -0.08 -0.09
## PACF  0.02  0.04  0.02 -0.11 -0.10  0.08 -0.04 -0.11 -0.07  0.07  0.02  0.02
##      [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49]
## ACF  -0.09 -0.07 -0.06 -0.05 -0.07 -0.06 -0.07 -0.08 -0.08 -0.07 -0.07 -0.07
## PACF  0.01  0.00 -0.02  0.03  0.00  0.06 -0.04 -0.02  0.07  0.15 -0.10 -0.04
##      [,50] [,51] [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60]
## ACF  -0.08 -0.11 -0.13 -0.17 -0.21 -0.24 -0.29 -0.32 -0.35 -0.34 -0.32
## PACF -0.05 -0.03 -0.02 -0.02 -0.15 -0.06 -0.13  0.00  0.01  0.05 -0.05</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="chapter-6-lab.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the seasonal model to x</span></span>
<span id="cb121-2"><a href="chapter-6-lab.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima</span>(x, <span class="at">p =</span> <span class="dv">0</span>, <span class="at">d =</span> <span class="dv">0</span>, <span class="at">q =</span> <span class="dv">0</span>, <span class="at">P =</span> <span class="dv">1</span>, <span class="at">D =</span> <span class="dv">0</span>, <span class="at">Q =</span> <span class="dv">1</span>, <span class="at">S =</span> <span class="dv">12</span>)</span></code></pre></div>
<pre><code>## initial  value 0.958236 
## iter   2 value 0.876547
## iter   3 value 0.812976
## iter   4 value 0.777142
## iter   5 value 0.747937
## iter   6 value 0.725263
## iter   7 value 0.719720
## iter   8 value 0.693755
## iter   9 value 0.690447
## iter  10 value 0.681477
## iter  11 value 0.680611
## iter  12 value 0.680126
## iter  13 value 0.679664
## iter  14 value 0.678787
## iter  15 value 0.678244
## iter  16 value 0.678215
## iter  17 value 0.678182
## iter  18 value 0.678167
## iter  19 value 0.678158
## iter  20 value 0.678128
## iter  21 value 0.678102
## iter  22 value 0.678085
## iter  23 value 0.678084
## iter  24 value 0.678084
## iter  25 value 0.678083
## iter  26 value 0.678083
## iter  27 value 0.678083
## iter  28 value 0.678083
## iter  29 value 0.678083
## iter  29 value 0.678083
## final  value 0.678083 
## converged
## initial  value 1.316632 
## iter   2 value 1.078864
## iter   3 value 1.008425
## iter   4 value 0.990485
## iter   5 value 0.972791
## iter   6 value 0.957820
## iter   7 value 0.946498
## iter   8 value 0.936672
## iter   9 value 0.929951
## iter  10 value 0.915219
## iter  11 value 0.913770
## iter  12 value 0.904973
## iter  13 value 0.903657
## iter  14 value 0.903549
## iter  15 value 0.903545
## iter  16 value 0.903544
## iter  17 value 0.903543
## iter  18 value 0.903542
## iter  19 value 0.903542
## iter  19 value 0.903542
## iter  19 value 0.903542
## final  value 0.903542 
## converged</code></pre>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## stats::arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, 
##     Q), period = S), xreg = xmean, include.mean = FALSE, transform.pars = trans, 
##     fixed = fixed, optim.control = list(trace = trc, REPORT = 1, reltol = tol))
## 
## Coefficients:
##         sar1     sma1    xmean
##       0.7141  -0.2117  34.4740
## s.e.  0.1099   0.1181   0.5357
## 
## sigma^2 estimated as 5.785:  log likelihood = -232.25,  aic = 472.5
## 
## $degrees_of_freedom
## [1] 97
## 
## $ttable
##       Estimate     SE t.value p.value
## sar1    0.7141 0.1099  6.4973  0.0000
## sma1   -0.2117 0.1181 -1.7927  0.0761
## xmean  34.4740 0.5357 64.3483  0.0000
## 
## $AIC
## [1] 4.724962
## 
## $AICc
## [1] 4.727462
## 
## $BIC
## [1] 4.829169</code></pre>
<p>However, pure seasonal won’t be likely. Data in real life will tend to be mixed seasonal model (specified p, d, q in addition to P, D, Q, S)</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="chapter-6-lab.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot sample P/ACF pair to lag 60 and compare to actual</span></span>
<span id="cb124-2"><a href="chapter-6-lab.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf2</span>(x,  <span class="at">max.lag =</span> <span class="dv">60</span>)</span></code></pre></div>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre><code>##      [,1] [,2]  [,3]  [,4]  [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
## ACF   0.9 0.82  0.73  0.64  0.56 0.50 0.48 0.45 0.44  0.42  0.40   0.4  0.37
## PACF  0.9 0.04 -0.07 -0.04 -0.02 0.05 0.15 0.03 0.03 -0.07  0.04   0.1 -0.09
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
## ACF   0.35  0.36  0.36  0.37  0.36  0.36  0.34  0.34  0.32  0.29  0.27  0.20
## PACF  0.05  0.13  0.04  0.02 -0.08  0.06 -0.06  0.09 -0.02 -0.11 -0.01 -0.19
##      [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
## ACF   0.16  0.12  0.10  0.07  0.03  0.02  0.00 -0.03 -0.06 -0.08 -0.08 -0.09
## PACF  0.02  0.04  0.02 -0.11 -0.10  0.08 -0.04 -0.11 -0.07  0.07  0.02  0.02
##      [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49]
## ACF  -0.09 -0.07 -0.06 -0.05 -0.07 -0.06 -0.07 -0.08 -0.08 -0.07 -0.07 -0.07
## PACF  0.01  0.00 -0.02  0.03  0.00  0.06 -0.04 -0.02  0.07  0.15 -0.10 -0.04
##      [,50] [,51] [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60]
## ACF  -0.08 -0.11 -0.13 -0.17 -0.21 -0.24 -0.29 -0.32 -0.35 -0.34 -0.32
## PACF -0.05 -0.03 -0.02 -0.02 -0.15 -0.06 -0.13  0.00  0.01  0.05 -0.05</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="chapter-6-lab.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the seasonal model to x</span></span>
<span id="cb126-2"><a href="chapter-6-lab.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima</span>(x, <span class="at">p =</span> <span class="dv">0</span>, <span class="at">d =</span> <span class="dv">0</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">P =</span> <span class="dv">0</span>, <span class="at">D =</span> <span class="dv">0</span>, <span class="at">Q =</span> <span class="dv">1</span>, <span class="at">S =</span> <span class="dv">12</span>)</span></code></pre></div>
<pre><code>## initial  value 1.040726 
## iter   2 value 0.685896
## iter   3 value 0.666207
## iter   4 value 0.607557
## iter   5 value 0.602804
## iter   6 value 0.596031
## iter   7 value 0.595761
## iter   8 value 0.595755
## iter   9 value 0.595754
## iter  10 value 0.595754
## iter  11 value 0.595754
## iter  12 value 0.595754
## iter  12 value 0.595754
## iter  12 value 0.595754
## final  value 0.595754 
## converged
## initial  value 0.588139 
## iter   2 value 0.587695
## iter   3 value 0.587540
## iter   4 value 0.587468
## iter   5 value 0.587440
## iter   6 value 0.587440
## iter   7 value 0.587440
## iter   7 value 0.587440
## iter   7 value 0.587440
## final  value 0.587440 
## converged</code></pre>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## stats::arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, 
##     Q), period = S), xreg = xmean, include.mean = FALSE, transform.pars = trans, 
##     fixed = fixed, optim.control = list(trace = trc, REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ma1    sma1    xmean
##       0.7270  0.2512  34.4628
## s.e.  0.0588  0.0803   0.3758
## 
## sigma^2 estimated as 3.189:  log likelihood = -200.64,  aic = 409.28
## 
## $degrees_of_freedom
## [1] 97
## 
## $ttable
##       Estimate     SE t.value p.value
## ma1     0.7270 0.0588 12.3579  0.0000
## sma1    0.2512 0.0803  3.1284  0.0023
## xmean  34.4628 0.3758 91.7171  0.0000
## 
## $AIC
## [1] 4.092756
## 
## $AICc
## [1] 4.095256
## 
## $BIC
## [1] 4.196963</code></pre>
</div>
<div id="exponential-smoothing-1" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Exponential smoothing</h2>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="chapter-6-lab.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb129-2"><a href="chapter-6-lab.html#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="chapter-6-lab.html#cb129-3" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">ses</span>(birth, <span class="at">h =</span> <span class="dv">10</span>)</span>
<span id="cb129-4"><a href="chapter-6-lab.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fc)</span></code></pre></div>
<pre><code>## 
## Forecast method: Simple exponential smoothing
## 
## Model Information:
## Simple exponential smoothing 
## 
## Call:
##  ses(y = birth, h = 10) 
## 
##   Smoothing parameters:
##     alpha = 0.7106 
## 
##   Initial states:
##     l = 292.9802 
## 
##   sigma:  16.2158
## 
##      AIC     AICc      BIC 
## 4291.087 4291.152 4302.851 
## 
## Error measures:
##                      ME     RMSE    MAE       MPE     MAPE     MASE        ACF1
## Training set -0.0570963 16.17222 13.034 -0.195208 4.228966 1.328423 -0.02023071
## 
## Forecasts:
##          Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
## Feb 1979       277.8466 257.0653 298.6279 246.0643 309.6289
## Mar 1979       277.8466 252.3528 303.3404 238.8572 316.8360
## Apr 1979       277.8466 248.3847 307.3085 232.7885 322.9047
## May 1979       277.8466 244.8910 310.8022 227.4453 328.2479
## Jun 1979       277.8466 241.7337 313.9595 222.6167 333.0765
## Jul 1979       277.8466 238.8311 316.8621 218.1775 337.5157
## Aug 1979       277.8466 236.1299 319.5633 214.0464 341.6468
## Sep 1979       277.8466 233.5933 322.0999 210.1671 345.5261
## Oct 1979       277.8466 231.1945 324.4987 206.4983 349.1949
## Nov 1979       277.8466 228.9131 326.7801 203.0092 352.6840</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="chapter-6-lab.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fc)</span></code></pre></div>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="chapter-6-lab.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the one-step forecasts for the training data to the plot</span></span>
<span id="cb132-2"><a href="chapter-6-lab.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fc) <span class="sc">+</span> <span class="fu">autolayer</span>(<span class="fu">fitted</span>(fc))</span></code></pre></div>
<p><img src="Chapter6_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>


<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="chapter-6-lab.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span></code></pre></div>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: TTR</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<pre><code>## Version 0.4-0 included new data defaults. See ?getSymbols.</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="chapter-6-lab.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="st">&quot;CPIAUCSL&quot;</span>, <span class="at">auto.assign =</span> <span class="cn">TRUE</span>, <span class="at">src =</span> <span class="st">&quot;FRED&quot;</span>)</span></code></pre></div>
<pre><code>## &#39;getSymbols&#39; currently uses auto.assign=TRUE by default, but will
## use auto.assign=FALSE in 0.5-0. You will still be able to use
## &#39;loadSymbols&#39; to automatically load data. getOption(&quot;getSymbols.env&quot;)
## and getOption(&quot;getSymbols.auto.assign&quot;) will still be checked for
## alternate defaults.
## 
## This message is shown once per session and may be disabled by setting 
## options(&quot;getSymbols.warning4.0&quot;=FALSE). See ?getSymbols for details.</code></pre>
<pre><code>## [1] &quot;CPIAUCSL&quot;</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="chapter-6-lab.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="st">&quot;USSTHPI&quot;</span>, <span class="at">auto.assign =</span> <span class="cn">TRUE</span>, <span class="at">src =</span> <span class="st">&quot;FRED&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;USSTHPI&quot;</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="chapter-6-lab.html#cb146-1" aria-hidden="true" tabindex="-1"></a>CPI <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/CPIAUCSL.csv&quot;</span>)</span>
<span id="cb146-2"><a href="chapter-6-lab.html#cb146-2" aria-hidden="true" tabindex="-1"></a>USHousePriceIndex <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/USSTHPI.csv&quot;</span>)</span>
<span id="cb146-3"><a href="chapter-6-lab.html#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="chapter-6-lab.html#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CPIAUCSL)</span></code></pre></div>
<p><img src="FinalReport_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="chapter-6-lab.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(USSTHPI)</span></code></pre></div>
<p><img src="FinalReport_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-6-forecasting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Econ481f20/YOUR REPO NAME/edit/master/Chapter6.Rmd",
"text": "Edit"
},
"history": {
"link": "https://github.com/Econ481f20/YOUR REPO NAME/commits/master/Chapter6.Rmd",
"text": null
},
"view": {
"link": "https://github.com/Econ481f20/YOUR REPO NAME/blob/master/Chapter6.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
