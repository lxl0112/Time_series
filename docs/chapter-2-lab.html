<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Chapter 2 Lab | Time Series</title>
  <meta name="description" content="4 Chapter 2 Lab | Time Series" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Chapter 2 Lab | Time Series" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Chapter 2 Lab | Time Series" />
  
  
  

<meta name="author" content="Luke Le" />


<meta name="date" content="2021-11-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-2-modelling-trends-and-seasonal-patterns.html"/>
<link rel="next" href="chapter-3-autoregressive-processes.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html"><i class="fa fa-check"></i><b>1</b> Chapter 1: Time Series Fundamentals</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#definition"><i class="fa fa-check"></i><b>1.1</b> Definition</a></li>
<li class="chapter" data-level="1.2" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#white-noise-purely-random-process"><i class="fa fa-check"></i><b>1.2</b> White Noise: purely random process</a></li>
<li class="chapter" data-level="1.3" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#random-walk-random-but-dependent"><i class="fa fa-check"></i><b>1.3</b> Random Walk: random but dependent</a></li>
<li class="chapter" data-level="1.4" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#time-series-modelling"><i class="fa fa-check"></i><b>1.4</b> Time Series Modelling</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#log-transformation"><i class="fa fa-check"></i><b>1.4.1</b> Log Transformation</a></li>
<li class="chapter" data-level="1.4.2" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#box-cox-transformation"><i class="fa fa-check"></i><b>1.4.2</b> Box-Cox Transformation</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#time-series-properties"><i class="fa fa-check"></i><b>1.5</b> Time Series Properties</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#mean-function-if-mean-is-constant"><i class="fa fa-check"></i><b>1.5.1</b> Mean function (if mean is constant)</a></li>
<li class="chapter" data-level="1.5.2" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#variance-function-if-variance-is-constant"><i class="fa fa-check"></i><b>1.5.2</b> Variance function (if variance is constant)</a></li>
<li class="chapter" data-level="1.5.3" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#autocovariance-function-acvf"><i class="fa fa-check"></i><b>1.5.3</b> Autocovariance function (ACVF):</a></li>
<li class="chapter" data-level="1.5.4" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#autocorrelation-function-acf"><i class="fa fa-check"></i><b>1.5.4</b> Autocorrelation function (ACF):</a></li>
<li class="chapter" data-level="1.5.5" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#properties"><i class="fa fa-check"></i><b>1.5.5</b> Properties</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#stationarity"><i class="fa fa-check"></i><b>1.6</b> Stationarity</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html"><i class="fa fa-check"></i><b>2</b> Chapter 1 Lab</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html#white-noise-wn"><i class="fa fa-check"></i><b>2.1</b> White Noise (WN)</a></li>
<li class="chapter" data-level="2.2" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html#random-walk-rw"><i class="fa fa-check"></i><b>2.2</b> Random Walk (RW)</a></li>
<li class="chapter" data-level="2.3" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html#stationary"><i class="fa fa-check"></i><b>2.3</b> Stationary</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html#examples-cpi-data"><i class="fa fa-check"></i><b>2.3.1</b> Examples: CPI Data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapter-1-lab.html"><a href="chapter-1-lab.html#acf-to-time-series-plot"><i class="fa fa-check"></i><b>2.4</b> ACF to Time Series Plot</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html"><i class="fa fa-check"></i><b>3</b> Chapter 2: Modelling trends and seasonal patterns</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#method-1-regression"><i class="fa fa-check"></i><b>3.1</b> Method 1: Regression</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#examples"><i class="fa fa-check"></i><b>3.1.1</b> Examples</a></li>
<li class="chapter" data-level="3.1.2" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#other-common-models"><i class="fa fa-check"></i><b>3.1.2</b> Other common models</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#method-2-moving-average-smoothing"><i class="fa fa-check"></i><b>3.2</b> Method 2: Moving Average Smoothing</a></li>
<li class="chapter" data-level="3.3" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#method-3-differencing"><i class="fa fa-check"></i><b>3.3</b> Method 3: Differencing</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#remove-trends"><i class="fa fa-check"></i><b>3.3.1</b> Remove Trends</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#remove-seasonality"><i class="fa fa-check"></i><b>3.3.2</b> Remove Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#choosing-a-smoothing-parameter"><i class="fa fa-check"></i><b>3.4</b> Choosing a smoothing parameter</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#simplicity"><i class="fa fa-check"></i><b>3.4.1</b> Simplicity</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#objective-criteria-aic-bic"><i class="fa fa-check"></i><b>3.4.2</b> Objective criteria (AIC &amp; BIC)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-2-lab.html"><a href="chapter-2-lab.html"><i class="fa fa-check"></i><b>4</b> Chapter 2 Lab</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-2-lab.html"><a href="chapter-2-lab.html#model-choice-and-residual-analysis"><i class="fa fa-check"></i><b>4.1</b> Model choice and Residual analysis</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-2-lab.html"><a href="chapter-2-lab.html#data-example-annual-varve-series"><i class="fa fa-check"></i><b>4.2</b> Data Example: Annual Varve Series</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html"><i class="fa fa-check"></i><b>5</b> Chapter 3: Autoregressive processes</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#definition"><i class="fa fa-check"></i><b>5.1</b> Definition</a></li>
<li class="chapter" data-level="5.2" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#first-order-autoregressive-process"><i class="fa fa-check"></i><b>5.2</b> First order Autoregressive process</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#mean"><i class="fa fa-check"></i><b>5.2.1</b> Mean</a></li>
<li class="chapter" data-level="5.2.2" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#variance"><i class="fa fa-check"></i><b>5.2.2</b> Variance</a></li>
<li class="chapter" data-level="5.2.3" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#examples"><i class="fa fa-check"></i><b>5.2.3</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#arp-process"><i class="fa fa-check"></i><b>5.3</b> <span class="math inline">\(AR(p)\)</span> process</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#mean-1"><i class="fa fa-check"></i><b>5.3.1</b> Mean</a></li>
<li class="chapter" data-level="5.3.2" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#stationarity"><i class="fa fa-check"></i><b>5.3.2</b> Stationarity</a></li>
<li class="chapter" data-level="5.3.3" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#variance-1"><i class="fa fa-check"></i><b>5.3.3</b> Variance</a></li>
<li class="chapter" data-level="5.3.4" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#autocorrelation-function"><i class="fa fa-check"></i><b>5.3.4</b> Autocorrelation Function</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#when-and-how-to-use-arp-model"><i class="fa fa-check"></i><b>5.4</b> When and how to use AR(p) model</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#definition-of-pacf"><i class="fa fa-check"></i><b>5.4.1</b> Definition of PACF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter-3-lab.html"><a href="chapter-3-lab.html"><i class="fa fa-check"></i><b>6</b> Chapter 3 Lab</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-3-lab.html"><a href="chapter-3-lab.html#autoregressive-model-ar"><i class="fa fa-check"></i><b>6.1</b> Autoregressive model (AR)</a></li>
<li class="chapter" data-level="6.2" data-path="chapter-3-lab.html"><a href="chapter-3-lab.html#chicken-price"><i class="fa fa-check"></i><b>6.2</b> Chicken Price</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-3-lab.html"><a href="chapter-3-lab.html#chicken-price-1"><i class="fa fa-check"></i><b>6.3</b> Chicken price</a></li>
<li class="chapter" data-level="6.4" data-path="chapter-3-lab.html"><a href="chapter-3-lab.html#unemployment"><i class="fa fa-check"></i><b>6.4</b> Unemployment</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html"><i class="fa fa-check"></i><b>7</b> Chapter 4: Moving Average processes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#definition"><i class="fa fa-check"></i><b>7.1</b> Definition</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#mean-and-variance"><i class="fa fa-check"></i><b>7.2</b> Mean and Variance</a></li>
<li class="chapter" data-level="7.3" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#autocorrelation-functions"><i class="fa fa-check"></i><b>7.3</b> Autocorrelation functions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="chapter-2-modelling-trends-and-seasonal-patterns.html"><a href="chapter-2-modelling-trends-and-seasonal-patterns.html#examples"><i class="fa fa-check"></i><b>7.3.1</b> Examples:</a></li>
<li class="chapter" data-level="7.3.2" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#another-example"><i class="fa fa-check"></i><b>7.3.2</b> Another example</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#invertibility"><i class="fa fa-check"></i><b>7.4</b> Invertibility</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#inveritibility-theorem"><i class="fa fa-check"></i><b>7.4.1</b> Inveritibility Theorem</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#ma-model-identification"><i class="fa fa-check"></i><b>7.5</b> MA Model Identification</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="chapter-3-autoregressive-processes.html"><a href="chapter-3-autoregressive-processes.html#example"><i class="fa fa-check"></i><b>7.5.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#ma-parameter-estimation"><i class="fa fa-check"></i><b>7.6</b> MA parameter estimation</a></li>
<li class="chapter" data-level="7.7" data-path="chapter-4-moving-average-processes.html"><a href="chapter-4-moving-average-processes.html#ma-example"><i class="fa fa-check"></i><b>7.7</b> MA Example</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-4-lab.html"><a href="chapter-4-lab.html"><i class="fa fa-check"></i><b>8</b> Chapter 4 Lab</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter-4-lab.html"><a href="chapter-4-lab.html#moving-average-model-ma"><i class="fa fa-check"></i><b>8.1</b> Moving Average model (MA)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html"><i class="fa fa-check"></i><b>9</b> Chapter 5: More general time series processes</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arma-model"><i class="fa fa-check"></i><b>9.1</b> ARMA model</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#mean-of-armapq-process"><i class="fa fa-check"></i><b>9.1.1</b> Mean of ARMA(p,q) process</a></li>
<li class="chapter" data-level="9.1.2" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#variance-and-autocorrelation-function"><i class="fa fa-check"></i><b>9.1.2</b> Variance and autocorrelation function</a></li>
<li class="chapter" data-level="9.1.3" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#stationarity-and-invertibility"><i class="fa fa-check"></i><b>9.1.3</b> Stationarity and Invertibility</a></li>
<li class="chapter" data-level="9.1.4" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arma-model-identification"><i class="fa fa-check"></i><b>9.1.4</b> ARMA model identification</a></li>
<li class="chapter" data-level="9.1.5" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arma-parameter-estimation"><i class="fa fa-check"></i><b>9.1.5</b> ARMA parameter estimation</a></li>
<li class="chapter" data-level="9.1.6" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arma-simulation-example"><i class="fa fa-check"></i><b>9.1.6</b> ARMA simulation example</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arima-model"><i class="fa fa-check"></i><b>9.2</b> ARIMA model</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#definition"><i class="fa fa-check"></i><b>9.2.1</b> Definition</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#arima-model-identification"><i class="fa fa-check"></i><b>9.2.2</b> ARIMA model identification</a></li>
<li class="chapter" data-level="9.2.3" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#example-1"><i class="fa fa-check"></i><b>9.2.3</b> Example 1</a></li>
<li class="chapter" data-level="9.2.4" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#example-2"><i class="fa fa-check"></i><b>9.2.4</b> Example 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter-5-lab.html"><a href="chapter-5-lab.html"><i class="fa fa-check"></i><b>10</b> Chapter 5 Lab</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter-5-lab.html"><a href="chapter-5-lab.html#oil-return"><i class="fa fa-check"></i><b>10.1</b> Oil Return</a></li>
<li class="chapter" data-level="10.2" data-path="chapter-5-lab.html"><a href="chapter-5-lab.html#air-passengers"><i class="fa fa-check"></i><b>10.2</b> Air Passengers</a></li>
<li class="chapter" data-level="10.3" data-path="chapter-5-lab.html"><a href="chapter-5-lab.html#birth-rate"><i class="fa fa-check"></i><b>10.3</b> Birth Rate</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html"><i class="fa fa-check"></i><b>11</b> Chapter 6: Forecasting</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#general-problem"><i class="fa fa-check"></i><b>11.1</b> General problem</a></li>
<li class="chapter" data-level="11.2" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#regression"><i class="fa fa-check"></i><b>11.2</b> Regression</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#example-1"><i class="fa fa-check"></i><b>11.2.1</b> Example 1</a></li>
<li class="chapter" data-level="11.2.2" data-path="chapter-5-more-general-time-series-processes.html"><a href="chapter-5-more-general-time-series-processes.html#example-2"><i class="fa fa-check"></i><b>11.2.2</b> Example 2</a></li>
<li class="chapter" data-level="11.2.3" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#example-3"><i class="fa fa-check"></i><b>11.2.3</b> Example 3</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#exponential-smoothing"><i class="fa fa-check"></i><b>11.3</b> Exponential smoothing</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="chapter-1-time-series-fundamentals.html"><a href="chapter-1-time-series-fundamentals.html#definition"><i class="fa fa-check"></i><b>11.3.1</b> Definition</a></li>
<li class="chapter" data-level="11.3.2" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#choosing-alpha"><i class="fa fa-check"></i><b>11.3.2</b> Choosing <span class="math inline">\(\alpha\)</span></a></li>
<li class="chapter" data-level="11.3.3" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#measure-uncertainty"><i class="fa fa-check"></i><b>11.3.3</b> Measure uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#forecasting-from-arp-models"><i class="fa fa-check"></i><b>11.4</b> Forecasting from AR(p) models</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#ar1-forecasting"><i class="fa fa-check"></i><b>11.4.1</b> AR(1) forecasting</a></li>
<li class="chapter" data-level="11.4.2" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#arp-forecasting"><i class="fa fa-check"></i><b>11.4.2</b> AR(p) forecasting</a></li>
<li class="chapter" data-level="11.4.3" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#example-1-simulated-data"><i class="fa fa-check"></i><b>11.4.3</b> Example 1: Simulated data</a></li>
<li class="chapter" data-level="11.4.4" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#example-2-1"><i class="fa fa-check"></i><b>11.4.4</b> Example 2</a></li>
<li class="chapter" data-level="11.4.5" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#example-3-1"><i class="fa fa-check"></i><b>11.4.5</b> Example 3</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#forecasting-from-maq-models"><i class="fa fa-check"></i><b>11.5</b> Forecasting from MA(q) models</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#ma1-forecast"><i class="fa fa-check"></i><b>11.5.1</b> MA(1) forecast</a></li>
<li class="chapter" data-level="11.5.2" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#maq-forecasts"><i class="fa fa-check"></i><b>11.5.2</b> MA(q) forecasts</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#forecasting-time-series-with-trend-seasonality-and-correlation"><i class="fa fa-check"></i><b>11.6</b> Forecasting time series with trend, seasonality and correlation</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="chapter-6-forecasting.html"><a href="chapter-6-forecasting.html#example-4"><i class="fa fa-check"></i><b>11.6.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chapter-6-lab.html"><a href="chapter-6-lab.html"><i class="fa fa-check"></i><b>12</b> Chapter 6 Lab</a>
<ul>
<li class="chapter" data-level="12.1" data-path="chapter-6-lab.html"><a href="chapter-6-lab.html#forecasting-with-arima"><i class="fa fa-check"></i><b>12.1</b> Forecasting with ARIMA</a></li>
<li class="chapter" data-level="12.2" data-path="chapter-6-lab.html"><a href="chapter-6-lab.html#global-temp-data"><i class="fa fa-check"></i><b>12.2</b> Global Temp data</a></li>
<li class="chapter" data-level="12.3" data-path="chapter-6-lab.html"><a href="chapter-6-lab.html#exponential-smoothing-1"><i class="fa fa-check"></i><b>12.3</b> Exponential smoothing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-2-lab" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Chapter 2 Lab</h1>
<div id="model-choice-and-residual-analysis" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Model choice and Residual analysis</h2>
<p>AIC and BIC are great measures for fit of models:</p>
<p><span class="math display">\[ average(observed-predicted)^2+k(p+q)\]</span>
The smaller these measures are, the better the prediction.</p>
<p>sarima() fucntion returns 4 graphs. Given we want the model to predict most of the observed data, and the residuals are just white noise, these 4 tools can help us identify whether residuals are just white noise:</p>
<ol style="list-style-type: decimal">
<li>Standardized residuals: does it look like white noise?</li>
<li>Sample ACF of residuals: no statistically significant ACF (everything within the blue lines)</li>
<li>Normal Q-Q plot: it should look like a line with a few outliers</li>
<li>Q-statistic p-values: all p-values should be above the line</li>
</ol>
<p>Finding the right model most of the time are through trials and errors starting with some ideas based off what we know about the data.</p>
</div>
<div id="data-example-annual-varve-series" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Data Example: Annual Varve Series</h2>
<p>Sedimentary deposits from one location in Massachusetts for 634 years, beginning nearly 12,000 years ago. Loaded from library astsa</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter-2-lab.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa)</span>
<span id="cb13-2"><a href="chapter-2-lab.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(varve)</span></code></pre></div>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chapter-2-lab.html#cb14-1" aria-hidden="true" tabindex="-1"></a>dl_varve <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(varve))</span>
<span id="cb14-2"><a href="chapter-2-lab.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(dl_varve)</span></code></pre></div>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<p>From the time series plot, it does not look like the data has a obvious linear trend, therefore first order differencing is most appropriate to tranform the data into a stationary process. It looks like it has a constant mean but moving average, suggesting MA(q) models might be appropriate. We will take a look at the ACF and PACF plots to further access:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="chapter-2-lab.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf2</span>(varve)</span></code></pre></div>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
## ACF  0.59 0.52 0.44 0.42 0.39 0.40 0.36 0.34 0.32  0.29  0.30  0.30  0.27  0.33
## PACF 0.59 0.25 0.11 0.11 0.07 0.11 0.03 0.02 0.02  0.01  0.06  0.04 -0.01  0.14
##      [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26]
## ACF   0.32  0.28  0.27  0.26  0.24  0.28  0.31  0.30  0.31  0.28  0.27  0.25
## PACF  0.05 -0.04  0.00  0.00  0.00  0.08  0.08  0.03  0.04  0.00  0.00 -0.04
##      [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36]
## ACF   0.26  0.24  0.23  0.20   0.2  0.24  0.21  0.22  0.23  0.19
## PACF  0.03 -0.02 -0.02 -0.02   0.0  0.09  0.00  0.02  0.02 -0.07</code></pre>
<p>The correlograms on the time plot of varve did not tell us a great deal here, which is expected. Now we will look at the ACF and PACF of the first order difference series:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="chapter-2-lab.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf2</span>(dl_varve)</span></code></pre></div>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]
## ACF  -0.4 -0.04 -0.06  0.01  0.00  0.04 -0.04  0.04  0.01 -0.05  0.06 -0.06
## PACF -0.4 -0.24 -0.23 -0.18 -0.15 -0.08 -0.11 -0.05 -0.01 -0.07  0.02 -0.05
##      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
## ACF  -0.04  0.08 -0.02  0.01  0.00  0.03 -0.05 -0.06  0.07  0.04 -0.06  0.05
## PACF -0.12 -0.03 -0.05 -0.04 -0.03  0.03 -0.03 -0.13 -0.04  0.01 -0.06  0.01
##      [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36]
## ACF  -0.01 -0.04  0.05 -0.05  0.03 -0.02  0.00  0.06 -0.05 -0.03  0.04 -0.05
## PACF  0.02 -0.04  0.03 -0.02  0.00 -0.03 -0.02  0.04 -0.02 -0.02  0.01 -0.07</code></pre>
<p>Based on ACF, MA(1) model might be appropriate. Based on PACF, AR(5) might be appropriate, however, I would start with smallest value of p for simplicity of the model</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapter-2-lab.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit an MA(1) to dl_varve.   </span></span>
<span id="cb19-2"><a href="chapter-2-lab.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima</span>(dl_varve, <span class="at">p =</span> <span class="dv">0</span>, <span class="at">d =</span> <span class="dv">0</span>, <span class="at">q =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## initial  value -0.551780 
## iter   2 value -0.671633
## iter   3 value -0.706234
## iter   4 value -0.707586
## iter   5 value -0.718543
## iter   6 value -0.719692
## iter   7 value -0.721967
## iter   8 value -0.722970
## iter   9 value -0.723231
## iter  10 value -0.723247
## iter  11 value -0.723248
## iter  12 value -0.723248
## iter  12 value -0.723248
## iter  12 value -0.723248
## final  value -0.723248 
## converged
## initial  value -0.722762 
## iter   2 value -0.722764
## iter   3 value -0.722764
## iter   4 value -0.722765
## iter   4 value -0.722765
## iter   4 value -0.722765
## final  value -0.722765 
## converged</code></pre>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## stats::arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, 
##     Q), period = S), xreg = xmean, include.mean = FALSE, transform.pars = trans, 
##     fixed = fixed, optim.control = list(trace = trc, REPORT = 1, reltol = tol))
## 
## Coefficients:
##           ma1    xmean
##       -0.7710  -0.0013
## s.e.   0.0341   0.0044
## 
## sigma^2 estimated as 0.2353:  log likelihood = -440.68,  aic = 887.36
## 
## $degrees_of_freedom
## [1] 631
## 
## $ttable
##       Estimate     SE  t.value p.value
## ma1    -0.7710 0.0341 -22.6002  0.0000
## xmean  -0.0013 0.0044  -0.2818  0.7782
## 
## $AIC
## [1] 1.401826
## 
## $AICc
## [1] 1.401856
## 
## $BIC
## [1] 1.422918</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chapter-2-lab.html#cb22-1" aria-hidden="true" tabindex="-1"></a>model_ma1 <span class="ot">&lt;-</span> <span class="fu">arima</span>(dl_varve, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb22-2"><a href="chapter-2-lab.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model_ma1)</span></code></pre></div>
<pre><code>## [1] 887.3557</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chapter-2-lab.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model_ma1)</span></code></pre></div>
<pre><code>## [1] 900.7071</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chapter-2-lab.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit an MA(2) to dl_varve. Improvement?</span></span>
<span id="cb26-2"><a href="chapter-2-lab.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima</span>(dl_varve, <span class="at">p =</span> <span class="dv">0</span>, <span class="at">d =</span> <span class="dv">0</span>, <span class="at">q =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## initial  value -0.551780 
## iter   2 value -0.679736
## iter   3 value -0.728605
## iter   4 value -0.734640
## iter   5 value -0.735449
## iter   6 value -0.735979
## iter   7 value -0.736015
## iter   8 value -0.736059
## iter   9 value -0.736060
## iter  10 value -0.736060
## iter  11 value -0.736061
## iter  12 value -0.736061
## iter  12 value -0.736061
## iter  12 value -0.736061
## final  value -0.736061 
## converged
## initial  value -0.735372 
## iter   2 value -0.735378
## iter   3 value -0.735379
## iter   4 value -0.735379
## iter   4 value -0.735379
## iter   4 value -0.735379
## final  value -0.735379 
## converged</code></pre>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## stats::arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, 
##     Q), period = S), xreg = xmean, include.mean = FALSE, transform.pars = trans, 
##     fixed = fixed, optim.control = list(trace = trc, REPORT = 1, reltol = tol))
## 
## Coefficients:
##           ma1      ma2    xmean
##       -0.6710  -0.1595  -0.0013
## s.e.   0.0375   0.0392   0.0033
## 
## sigma^2 estimated as 0.2294:  log likelihood = -432.69,  aic = 873.39
## 
## $degrees_of_freedom
## [1] 630
## 
## $ttable
##       Estimate     SE  t.value p.value
## ma1    -0.6710 0.0375 -17.9057  0.0000
## ma2    -0.1595 0.0392  -4.0667  0.0001
## xmean  -0.0013 0.0033  -0.4007  0.6888
## 
## $AIC
## [1] 1.379757
## 
## $AICc
## [1] 1.379817
## 
## $BIC
## [1] 1.40788</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="chapter-2-lab.html#cb29-1" aria-hidden="true" tabindex="-1"></a>model_ma2 <span class="ot">&lt;-</span> <span class="fu">arima</span>(dl_varve, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb29-2"><a href="chapter-2-lab.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model_ma2)</span></code></pre></div>
<pre><code>## [1] 873.3861</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="chapter-2-lab.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model_ma2)</span></code></pre></div>
<pre><code>## [1] 891.188</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter-2-lab.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit an ARMA(1,1) to dl_varve. Improvement?</span></span>
<span id="cb33-2"><a href="chapter-2-lab.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima</span>(dl_varve, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">d =</span> <span class="dv">0</span>, <span class="at">q =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## initial  value -0.550994 
## iter   2 value -0.648962
## iter   3 value -0.676965
## iter   4 value -0.699167
## iter   5 value -0.724554
## iter   6 value -0.726719
## iter   7 value -0.729066
## iter   8 value -0.731976
## iter   9 value -0.734235
## iter  10 value -0.735969
## iter  11 value -0.736410
## iter  12 value -0.737045
## iter  13 value -0.737600
## iter  14 value -0.737641
## iter  15 value -0.737643
## iter  16 value -0.737643
## iter  17 value -0.737643
## iter  18 value -0.737643
## iter  18 value -0.737643
## iter  18 value -0.737643
## final  value -0.737643 
## converged
## initial  value -0.737522 
## iter   2 value -0.737527
## iter   3 value -0.737528
## iter   4 value -0.737529
## iter   5 value -0.737530
## iter   5 value -0.737530
## iter   5 value -0.737530
## final  value -0.737530 
## converged</code></pre>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## stats::arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, 
##     Q), period = S), xreg = xmean, include.mean = FALSE, transform.pars = trans, 
##     fixed = fixed, optim.control = list(trace = trc, REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ar1      ma1    xmean
##       0.2341  -0.8871  -0.0013
## s.e.  0.0518   0.0292   0.0028
## 
## sigma^2 estimated as 0.2284:  log likelihood = -431.33,  aic = 870.66
## 
## $degrees_of_freedom
## [1] 630
## 
## $ttable
##       Estimate     SE  t.value p.value
## ar1     0.2341 0.0518   4.5184  0.0000
## ma1    -0.8871 0.0292 -30.4107  0.0000
## xmean  -0.0013 0.0028  -0.4618  0.6444
## 
## $AIC
## [1] 1.375456
## 
## $AICc
## [1] 1.375517
## 
## $BIC
## [1] 1.403579</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="chapter-2-lab.html#cb36-1" aria-hidden="true" tabindex="-1"></a>model_arma11 <span class="ot">&lt;-</span> <span class="fu">arima</span>(dl_varve, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb36-2"><a href="chapter-2-lab.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model_arma11)</span></code></pre></div>
<pre><code>## [1] 870.6638</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="chapter-2-lab.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model_arma11)</span></code></pre></div>
<pre><code>## [1] 888.4657</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="chapter-2-lab.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit an ARMA(2,1) to dl_varve. Improvement?</span></span>
<span id="cb40-2"><a href="chapter-2-lab.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima</span>(dl_varve, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">d =</span> <span class="dv">0</span>, <span class="at">q =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## initial  value -0.550651 
## iter   2 value -0.656533
## iter   3 value -0.691671
## iter   4 value -0.699615
## iter   5 value -0.714090
## iter   6 value -0.721637
## iter   7 value -0.724629
## iter   8 value -0.731357
## iter   9 value -0.733142
## iter  10 value -0.733786
## iter  11 value -0.734198
## iter  12 value -0.734623
## iter  13 value -0.735038
## iter  14 value -0.735325
## iter  15 value -0.735348
## iter  16 value -0.735350
## iter  17 value -0.735350
## iter  17 value -0.735350
## iter  17 value -0.735350
## final  value -0.735350 
## converged
## initial  value -0.737984 
## iter   2 value -0.738073
## iter   3 value -0.738128
## iter   4 value -0.738306
## iter   5 value -0.738336
## iter   6 value -0.738337
## iter   6 value -0.738337
## iter   6 value -0.738337
## final  value -0.738337 
## converged</code></pre>
<p><img src="Chapter2_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## stats::arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, 
##     Q), period = S), xreg = xmean, include.mean = FALSE, transform.pars = trans, 
##     fixed = fixed, optim.control = list(trace = trc, REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ar1     ar2      ma1    xmean
##       0.2447  0.0483  -0.9055  -0.0013
## s.e.  0.0501  0.0473   0.0298   0.0026
## 
## sigma^2 estimated as 0.228:  log likelihood = -430.82,  aic = 871.64
## 
## $degrees_of_freedom
## [1] 629
## 
## $ttable
##       Estimate     SE  t.value p.value
## ar1     0.2447 0.0501   4.8837  0.0000
## ar2     0.0483 0.0473   1.0192  0.3085
## ma1    -0.9055 0.0298 -30.3958  0.0000
## xmean  -0.0013 0.0026  -0.5044  0.6141
## 
## $AIC
## [1] 1.377002
## 
## $AICc
## [1] 1.377102
## 
## $BIC
## [1] 1.412156</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="chapter-2-lab.html#cb43-1" aria-hidden="true" tabindex="-1"></a>model_arma21 <span class="ot">&lt;-</span> <span class="fu">arima</span>(dl_varve, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb43-2"><a href="chapter-2-lab.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model_arma21)</span></code></pre></div>
<pre><code>## [1] 871.6421</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="chapter-2-lab.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model_arma21)</span></code></pre></div>
<pre><code>## [1] 893.8945</code></pre>
<p>Here we tried fitting ARIMA(0,0,1), ARIMA(0,0,2), ARIMA(1,0,1), and ARIMA(2,0,1), which are MA(1), MA(2), ARMA(1,1), and ARMA(2,1), respectively. ARMA(1,1) and ARMA(2,1) are better options than MA(1) and MA(2) based on the AIC and BIC and other statistics tell that the residuals resemble more of white noise.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-2-modelling-trends-and-seasonal-patterns.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-3-autoregressive-processes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Econ481f20/YOUR REPO NAME/edit/master/Chapter2.Rmd",
"text": "Edit"
},
"history": {
"link": "https://github.com/Econ481f20/YOUR REPO NAME/commits/master/Chapter2.Rmd",
"text": null
},
"view": {
"link": "https://github.com/Econ481f20/YOUR REPO NAME/blob/master/Chapter2.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
